import{b as U,i as $,u as K,r as i,z as p,k as _,j as e,D as u,U as B,C as G}from"./index-DA7c_E-X.js";import{N as J}from"./Navbar-B08Jjj6f.js";import{a as x}from"./axiosService-Cn-l7JZq.js";import{G as j}from"./iconBase-0wn4fA3J.js";import{s as b}from"./toaster-CDKtkdIq.js";import{F as W}from"./index-Ip-uKgKN.js";import{a as q}from"./axios-B6xwUs71.js";import"./logo-CI8ZzsgX.js";import"./index-VWaDGczM.js";import"./logout-N69Hl7hh.js";import"./Set_Get-jfIHgayU.js";function Q(l){return j({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M15 4H5V20H19V8H15V4ZM3 2.9918C3 2.44405 3.44749 2 3.9985 2H16L20.9997 7L21 20.9925C21 21.5489 20.5551 22 20.0066 22H3.9934C3.44476 22 3 21.5447 3 21.0082V2.9918ZM11 11V8H13V11H16V13H13V16H11V13H8V11H11Z"},child:[]}]})(l)}function X(l){return j({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0 0 42 42h216v494zM504 618H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM312 490v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8z"},child:[]}]})(l)}function Y(l){return j({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M912 302.3L784 376V224c0-35.3-28.7-64-64-64H128c-35.3 0-64 28.7-64 64v576c0 35.3 28.7 64 64 64h592c35.3 0 64-28.7 64-64V648l128 73.7c21.3 12.3 48-3.1 48-27.6V330c0-24.6-26.7-40-48-27.7zM712 792H136V232h576v560zm176-167l-104-59.8V458.9L888 399v226zM208 360h112c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H208c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"},child:[]}]})(l)}const ee=()=>{var v;const{id:l}=U(),m=$(s=>s.DoctorSlice),w=K(),[n,C]=i.useState(null),[P,D]=i.useState(!0),[M,h]=i.useState(!1),[f,S]=i.useState(new Date().toISOString().split("T")[0]),[V,I]=i.useState(""),[k,g]=i.useState(!1),[c,d]=i.useState([{name:"",dosage:"",instructions:""}]),[o,N]=i.useState(null),H=m.id,A=m.name,z=p.ZegoUIKitPrebuilt.generateKitTokenForTest(776225947,"2c92722a5b1c4470fd0709decb137d9b",null,H,A),y=p.ZegoUIKitPrebuilt.create(z);y.addPlugins({ZIM:_.ZIM});function T(){const s={userID:n.userId,userName:n.patientName};y.sendCallInvitation({callees:[s],callType:p.ZegoUIKitPrebuilt.InvitationTypeVideoCall,timeout:60}).then(a=>{console.warn(a)}).catch(a=>{console.warn(a)})}i.useEffect(()=>{const s=async()=>{try{const r=(await x.get(`${B}/bookingdetails/${l}`)).data.data.bookingDetails;C(r)}catch(t){console.error("Error fetching patient details:",t)}finally{D(!1)}},a=async()=>{try{const t=await x.get(`${u}/prescription/${l}`);t.data.response&&t.data.response.length>0&&N(t.data.response[0])}catch(t){console.error("Error fetching prescription details:",t)}};s(),a()},[l]);const E=()=>{h(!0)},L=()=>{g(!0)},O=()=>{h(!1)},Z=async()=>{const s={appointmentId:l,prescriptionDate:f,medicines:c};await x.post(`${u}/addPrescription`,s)&&b("Prescription added successfully","success"),h(!1)};if(P)return e.jsx("div",{className:"flex justify-center items-center h-screen bg-gray-100",children:e.jsx("p",{className:"text-xl font-semibold",children:"Loading..."})});const F=()=>{q.post(G+"/conversations",{senderId:n.userId,recieverId:m.id}).then(({data:s})=>{console.log(s,"data"),w("/doctor/chat")}).catch(()=>{console.log("error in sending chat")})};return e.jsxs("div",{className:"flex justify-center items-center py-10 bg-gray-100",children:[e.jsxs("div",{className:"w-full max-w-2xl bg-white rounded-lg shadow-lg p-6",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6 text-center",children:"Patient Details"}),n?e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg shadow-inner",children:[e.jsx("h2",{className:"font-bold text-gray-700",children:"Name"}),e.jsx("p",{className:"text-gray-900",children:n.patientName})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg shadow-inner",children:[e.jsx("h2",{className:"font-bold text-gray-700",children:"Age"}),e.jsx("p",{className:"text-gray-900",children:n.patientAge})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg shadow-inner",children:[e.jsx("h2",{className:"font-bold text-gray-700",children:"Gender"}),e.jsx("p",{className:"text-gray-900",children:n.patientGender})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg shadow-inner",children:[e.jsx("h2",{className:"font-bold text-gray-700",children:"Date"}),e.jsx("p",{className:"text-gray-900",children:new Date(n.date).toLocaleDateString()})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg shadow-inner",children:[e.jsx("h2",{className:"font-bold text-gray-700",children:"Time"}),e.jsx("p",{className:"text-gray-900",children:n.timeSlot})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg shadow-inner",children:[e.jsx("h2",{className:"font-bold text-gray-700",children:"Amount"}),e.jsx("p",{className:"text-gray-900",children:n.fee})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg shadow-inner",children:[e.jsx("h2",{className:"font-bold text-gray-700",children:"Payment Status"}),e.jsx("p",{className:"text-gray-900",children:n.paymentStatus})]}),n.appoinmentStatus==="Booked"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg shadow-inner",children:[e.jsx("h2",{className:"font-bold text-gray-700",children:"Chat with Patient"}),e.jsxs("button",{className:"bg-blue-500 text-white py-2 px-4 rounded-md shadow hover:bg-blue-800 flex items-center mt-3",onClick:F,children:[e.jsx(W,{className:"mr-2"})," Chat"]})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg shadow-inner",children:[e.jsx("h2",{className:"font-bold text-gray-700",children:"Join the Call"}),e.jsxs("button",{onClick:T,className:"bg-green-500 text-white py-2 px-4 rounded-md shadow hover:bg-green-800 flex items-center mt-3",children:[e.jsx(Y,{className:"mr-2"})," Video Call"]})]}),e.jsx("div",{className:"flex justify-center items-center mt-4 md:col-span-2",children:o?e.jsxs("button",{className:"bg-blue-900 text-white py-2 px-4 rounded-md shadow hover:bg-blue-800 flex items-center",onClick:L,children:[e.jsx(X,{className:"mr-2"})," View Prescription"]}):e.jsxs("button",{className:"bg-blue-900 text-white py-2 px-4 rounded-md shadow hover:bg-blue-800 flex items-center",onClick:E,children:[e.jsx(Q,{className:"mr-2"})," Add Prescription"]})})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-red-500 text-md font-bold ",children:"Appointment cancelled"}),e.jsxs("p",{className:"text-red-500 text-md font-bold ",children:["Reason: ",n.appoinmentCancelReason]})]})]}):e.jsx("p",{className:"text-center text-gray-700 ",children:"No patient details available."})]}),M&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-70",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-2xl",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Add Prescription"}),e.jsxs("div",{className:"mt-2 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Prescription Date"}),e.jsx("input",{type:"date",className:"border rounded-lg px-3 py-2 w-full focus:outline-none focus:border-blue-800",value:f,onChange:s=>S(s.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Doctor's Name"}),e.jsx("input",{type:"text",className:"border rounded-lg px-3 py-2 w-full focus:outline-none focus:border-blue-800",value:V,onChange:s=>I(s.target.value)})]}),c.map((s,a)=>e.jsxs("div",{className:"flex flex-col md:flex-row space-y-2 md:space-y-0 md:space-x-4",children:[e.jsx("input",{type:"text",className:"border rounded-lg px-3 py-2 w-full",placeholder:"Medicine Name",value:s.name,onChange:t=>{const r=[...c];r[a].name=t.target.value,d(r)}}),e.jsx("input",{type:"text",className:"border rounded-lg px-3 py-2 w-full",placeholder:"Dosage",value:s.dosage,onChange:t=>{const r=[...c];r[a].dosage=t.target.value,d(r)}}),e.jsx("input",{type:"text",className:"border rounded-lg px-3 py-2 w-full",placeholder:"Instructions",value:s.instructions,onChange:t=>{const r=[...c];r[a].instructions=t.target.value,d(r)}}),a>0&&e.jsx("button",{className:"text-red-600 hover:text-red-800",onClick:()=>{const t=c.filter((r,R)=>R!==a);d(t)},children:"Remove"})]},a)),e.jsx("button",{className:"text-blue-800 hover:text-blue-600 font-semibold",onClick:()=>d([...c,{name:"",dosage:"",instructions:""}]),children:"Add More Medicines"})]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-4",children:[e.jsx("button",{onClick:O,className:"bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600",children:"Cancel"}),e.jsx("button",{onClick:Z,className:"bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600",children:"Save"})]})]})}),k&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-70",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-2xl",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Prescription Details"}),o?e.jsxs("div",{children:[e.jsxs("div",{className:"mt-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Prescription Date"}),e.jsx("p",{className:"text-gray-900",children:new Date(o.prescriptionDate).toLocaleDateString()})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Medicines"}),e.jsx("ul",{className:"list-disc list-inside",children:(v=o==null?void 0:o.medicines)==null?void 0:v.map((s,a)=>e.jsxs("li",{className:"text-gray-900",children:[s.name," - ",s.dosage," - ",s.instructions]},a))})]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-4",children:[e.jsx("button",{onClick:()=>g(!1),className:"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600",children:"Close"}),e.jsx("button",{onClick:async()=>{try{await x.delete(`${u}/prescription/${o._id}`),b("Prescription deleted successfully","success"),N(null),g(!1)}catch(s){console.error("Error deleting prescription:",s),b("Error deleting prescription","error")}},className:"bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600",children:"Delete Prescription"})]})]}):e.jsx("p",{className:"text-center text-gray-700",children:"No prescription details available."})]})})]})},ge=()=>e.jsxs(e.Fragment,{children:[e.jsx(J,{}),e.jsx(ee,{})]});export{ge as default};
