import{c as Q,u as X,b as Y,r as i,j as e,U as f,d as ee,f as te}from"./index-DA7c_E-X.js";import{a as N}from"./axiosService-Cn-l7JZq.js";import{M as se}from"./index-CQ0PnwpE.js";import{s as p}from"./toaster-CDKtkdIq.js";/* empty css                         */const ce=()=>{const D=Q(),P=X(),{id:h}=Y(),[r,I]=i.useState(null),[j,R]=i.useState(""),[E,M]=i.useState({}),[A,G]=i.useState([]),[x,O]=i.useState([]),[v,y]=i.useState(""),[B,S]=i.useState(!1),[c,k]=i.useState(0),[m,T]=i.useState({patientName:"",patientAge:"",patientGender:"",patientNumber:"",patientProblem:""}),[F,C]=i.useState(!1);i.useEffect(()=>{(async()=>{try{const s=await N.get(`${f}/doctors/${h}`);I(s.data.doctor);const o=(await N.get(`${f}/departments`)).data.departments.filter(a=>a.isListed).reduce((a,l)=>(a[l._id]=l.departmentName,a),{});M(o),console.log(F);try{const l=(await N.get(`${f}/time-slots/${h}/dates`)).data.dateSlots.map(w=>w.date.split("T")[0]),u=new Date().toISOString().split("T")[0],b=l.filter(w=>w>=u),K=Array.from(new Set(b)).sort();O(K)}catch(a){console.error("Error fetching scheduled dates:",a)}}catch(s){console.error("Error fetching doctor n department details:",s)}})()},[h]);const q=()=>{j?S(!0):p("Please select both time slot and package.","error")},U=t=>{const{name:s,value:n}=t.target;T({...m,[s]:n})},g=t=>{const{name:s,value:n}=t.target;T({...m,[s]:n})},L=async()=>{try{const{patientName:t,patientAge:s,patientNumber:n,patientGender:d,patientProblem:o}=m,a=/^[a-zA-Z]+$/,l=/^\d+$/,u=/^\d{10}$/;if(!t||!a.test(t)){p("Please enter a valid name .","error");return}if(!s||!l.test(s)||parseInt(s)<3){p("Please enter a valid age (numeric value, at least 3 years old).","error");return}if(!d){p("Please Select a gender ","error");return}if(!n||!u.test(n)){p("Please enter a valid phone number (10 digits, numbers only).","error");return}if(!o.trim()){p("Please enter the patient's problem.","error");return}const b={doctorId:h||"",doctorName:r.doctorName,doctorImage:r.profileImage,fee:200,paymentStatus:"Pending",appoinmentStatus:"Booked",appoinmentCancelReason:"",timeSlot:j||"",date:v,patientName:t,patientAge:parseInt(s,10),patientGender:d,patientNumber:n,patientProblem:o};console.log("appointmentData data:",b),D(ee()),D(te(b)),P(`/user/checkout/${r==null?void 0:r._id}`)}catch(t){console.error("Error booking appointment:",t),p("Error booking appointment. Please try again later.","error")}},_=t=>{C(!0),R(t)},H=t=>{v===t?(y(""),y(t)):(y(t),C(!1),W(t))},W=async t=>{try{const n=(await N.get(`${f}/time-slots/${h}/dates`,{params:{date:t}})).data.timeSlots,d=new Date,o=new Date(t);o.setHours(0,0,0,0);const a=o.getTime()===new Date().setHours(0,0,0,0);let l=n;a&&(l=n.filter(u=>new Date(`${t} ${u.slotTime}`)>d)),G(l)}catch(s){console.error("Error fetching time slots:",s)}},z=()=>{q()},J=t=>{const s={weekday:"short",day:"numeric",month:"short"},d=new Date(t).toLocaleDateString("en-US",s).toUpperCase(),[o,a,l]=d.split(" ");return{weekday:o,day:a,month:l}},V=()=>{k(Math.max(c-1,0))},Z=()=>{k(Math.min(c+1,x.length-6))},$=x.slice(c,c+6);return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Book an Appointment"}),r&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-center mb-8",children:[e.jsx("img",{src:r.profileImage,alt:r.doctorName,className:"w-40 h-40 md:w-60 md:h-60 rounded mb-4 md:mb-0 mr-0 md:mr-4"}),e.jsxs("div",{className:"ml-0 md:ml-8 text-center md:text-left",children:[e.jsx("h2",{className:"text-xl font-bold",children:r.doctorName}),e.jsxs("p",{children:["              ",E[r==null?void 0:r.department]]}),e.jsxs("div",{className:"text-gray-800 bg-blue-100 p-4 rounded-md mt-5 font-bold",children:[e.jsx("p",{className:"mb-2",children:"Consultation: Online"}),e.jsx("p",{children:"Fee: 300/-"})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h1",{className:"ml-4 mt-6 font-medium text-blue-950 text-lg",children:"Select The Scheduled Date"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`cursor-pointer text-2xl ${c===0?"text-gray-400":"text-black"}`,onClick:c!==0?V:void 0,style:{color:c===0?"#A0A0A0":"#000000"},children:"<"}),e.jsx("div",{className:"grid grid-cols-6 gap-4 mx-4",children:$&&$.map((t,s)=>{const{weekday:n,day:d,month:o}=J(t),a=v===t;return e.jsxs("div",{className:`px-8 py-2 rounded-lg shadow-md flex flex-col items-center cursor-pointer ${a?"border-2 border-fuchsia-800 bg-fuchsia-700 text-white":"bg-white text-gray-600 hover:bg-gray-200"}`,onClick:()=>H(t),children:[e.jsx("input",{type:"radio",id:`dateSlot${s}`,name:"dateSlot",value:t,hidden:!0}),e.jsxs("label",{htmlFor:`dateSlot${s}`,className:"text-center",children:[e.jsx("div",{className:`text-sm ${a?"text-white":"text-gray-500"}`,children:n}),e.jsx("div",{className:`text-2xl font-bold ${a?"text-white":"text-black"}`,children:o}),e.jsx("div",{className:`text-sm ${a?"text-white":"text-gray-500"}`,children:d})]})]},s)})}),e.jsx("div",{className:`cursor-pointer text-2xl ${c===x.length-5?"text-gray-400":"text-black"}`,onClick:c!==x.length-5?Z:void 0,style:{color:c===x.length-5?"#A0A0A0":"#000000"},children:">"})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Available Time Slots"}),e.jsx("div",{className:"grid grid-cols-9 gap-4",children:A&&A.map((t,s)=>e.jsx("div",{className:`w-full rounded-md py-3 border border-gray-900 px-4 text-sm font-medium ${j===t.slotTime?"bg-fuchsia-800 text-white":"bg-white text-gray-600 hover:bg-gray-200"} shadow-md`,onClick:()=>_(t.slotTime),children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:`timeSlot${s}`,className:"text-lg font-bold",children:t.slotTime}),e.jsx("p",{className:t.available?"text-green-700":"text-red-600",children:t.available?"Available":"Not Available"})]})},s))})]}),e.jsx("div",{className:"flex justify-between mb-4",children:e.jsx("button",{onClick:z,className:"bg-fuchsia-800 text-white py-2 px-4 rounded-lg",children:"Book an Appointment"})}),e.jsxs(se,{isOpen:B,onRequestClose:()=>S(!1),style:{overlay:{backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center"},content:{position:"relative",top:"auto",left:"auto",right:"auto",bottom:"auto",width:"90%",maxWidth:"400px",borderRadius:"8px",boxShadow:"0px 0px 10px rgba(0, 0, 0, 0.2)",padding:"20px",margin:"0 auto"}},children:[e.jsx("button",{onClick:()=>S(!1),className:"absolute top-0 right-0 m-4 bg-gray-400 p-2 rounded",children:"close"}),e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Enter Patient Details"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block mb-1",children:"Name:"}),e.jsx("input",{type:"text",name:"patientName",value:m.patientName,onChange:g,className:"border border-gray-400 rounded-lg px-4 py-2 w-full mt-1"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block mb-1",children:"Age:"}),e.jsx("input",{type:"text",name:"patientAge",value:m.patientAge,onChange:g,className:"border border-gray-400 rounded-lg px-4 py-2 w-full mt-1"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block mb-1",children:"Gender:"}),e.jsxs("select",{name:"patientGender",value:m.patientGender,onChange:U,className:"border border-gray-400 rounded-lg px-4 py-2 w-full mt-1",children:[e.jsx("option",{value:"",children:"Select Gender"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"others",children:"Others"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"phoneNumber",className:"block mb-2",children:"Phone Number"}),e.jsx("input",{type:"text",required:!0,id:"phoneNumber",name:"patientNumber",value:m.patientNumber,onChange:g,className:"border rounded-lg px-4 py-2 w-full"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"problem",className:"block mb-2",children:"Problem"}),e.jsx("input",{id:"problem",required:!0,name:"patientProblem",value:m.patientProblem,onChange:g,className:"border rounded-lg px-4 py-2 w-full"})]}),e.jsx("button",{onClick:L,className:"bg-green-700 text-white py-2 px-4 rounded-lg",children:"Book Appointment"})]})]})]})};export{ce as A};
