import{u as E,r as c,D as v,n as R,p as V,j as t}from"./index-CfebaG3Z.js";import{N as O}from"./Navbar-mfJGHc2Z.js";import{F as M}from"./Footer-Ch2SnX8g.js";import{M as T}from"./index-Frm0jMI5.js";import{a as w}from"./axiosService-Cz6uC_ho.js";import{s as b}from"./toaster-CAIDXZc9.js";import{u as U,a as A}from"./uploadImages-C93VI_b2.js";import"./logo-CI8ZzsgX.js";import"./iconBase-BG7OcONe.js";import"./axios-B6xwUs71.js";import"./index-VWaDGczM.js";import"./logout-CT78rMfo.js";import"./Set_Get-jfIHgayU.js";const L=()=>{const n=E(),[s,f]=c.useState(null),[u,p]=c.useState(null),[g,l]=c.useState(!1),[x,m]=c.useState([]),[i,N]=c.useState({doctorName:"",gender:"",email:"",age:null,department:"",description:"",phoneNumber:"",education:"",status:"pending",imageFile:null,lisenceCertificate:null}),[P,C]=c.useState(null),[S,F]=c.useState(null),[I,y]=c.useState(!1);return c.useEffect(()=>{const d=async()=>{try{const{data:a}=await w.get(v+"/profile"),{doctor:e}=a;N(o=>({...o,doctorName:e==null?void 0:e.doctorName,age:e==null?void 0:e.age,gender:e==null?void 0:e.gender,department:e==null?void 0:e.department,description:e==null?void 0:e.description,education:e==null?void 0:e.education,email:e==null?void 0:e.email,phoneNumber:e==null?void 0:e.phoneNumber,lisenceCertificate:e==null?void 0:e.lisenceCertificate,status:e==null?void 0:e.status})),C((e==null?void 0:e.profileImage)||""),f((e==null?void 0:e.profileImage)||""),F((e==null?void 0:e.lisenceCertificate)||"")}catch(a){console.error("Error fetching profile data:",a),b("Oops! Something went wrong","error")}},r=async()=>{try{const{data:a}=await w.get(v+"/departments");m(a.departments)}catch(a){console.error("Error fetching departments:",a),b("Oops! Something went wrong while fetching departments","error")}};d(),r()},[]),{profile:s,formData:i,imagePreview:P,certificatePreview:S,error:u,isSubmitting:I,departments:x,handleInputChange:d=>{const{name:r,value:a}=d.target;let e="";if(r==="imageFile"||r==="lisenceCertificate"){const o=d.target,j=o.files&&o.files[0];if(j){const h=new FileReader;h.onloadend=()=>{r==="imageFile"?C(h.result):F(h.result)},h.readAsDataURL(j),N(k=>({...k,[r]:j}))}}else{if(r==="doctorName")a.trim()?R.test(a)||(e="First letter must be capital and no leading or trailing space"):e="Name is required";else if(r==="age"){const o=parseInt(a,10);(isNaN(o)||o<0)&&(e="Age must be a positive number")}else r==="phoneNumber"&&(a.trim()?V.test(a)||(e="Phone number must have 10 numbers"):e="Phone number is required");N(o=>({...o,[r]:r==="age"?parseInt(a,10):a}))}p(e)},handleSubmit:async()=>{if(!u){y(!0);try{const d=await U(i.imageFile),r=await A(i.lisenceCertificate),a=await w.patch(v+"/profile/edit",{doctorName:i.doctorName,gender:i.gender,age:i.age,phoneNumber:i.phoneNumber,department:i.department,education:i.education,description:i.description,profileImage:d||(s==null?void 0:s.profileImage),lisenceCertificate:r||(s==null?void 0:s.lisenceCertificate)});b(a.data.message),y(!1),n("/doctor")}catch(d){y(!1),console.error("Error updating profile:",d),b("Oops! Something went wrong while updating profile","error")}}},handleVerify:()=>{l(!0),console.log(g)}}},te=()=>{const{profile:n,formData:s,imagePreview:f,certificatePreview:u,isSubmitting:p,departments:g,handleInputChange:l,handleSubmit:x}=L();console.log("Profile:",n),console.log("Form Data:",s),console.log("Departments:",g);let m="";switch(s==null?void 0:s.status){case"pending":m="Please update the profile with all fields for verification and wait for admin to verify.";break;case"rejected":m="Verification of Doctor Rejected";break;case"approved":m="Verified Doctor";break}return t.jsxs(t.Fragment,{children:[t.jsx(O,{}),t.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:t.jsxs("div",{className:"flex flex-col items-center w-full max-w-4xl justify-center mb-10 mt-9 bg-gradient-to-r from-fuchsia-500 to-fuchsia-800 rounded-lg px-7 py-10 shadow-lg text-white relative",children:[t.jsx("h2",{className:"text-4xl font-bold mb-6 text-center",children:"K.Y.C Update"}),t.jsxs("div",{className:"bg-white w-full p-6 mb-3 rounded-lg shadow-lg",children:[t.jsxs("div",{className:"flex items-start mb-6",children:[t.jsx("div",{className:"flex-shrink-0 mr-6",children:t.jsxs("div",{className:"relative",children:[t.jsx("img",{src:f||((n==null?void 0:n.profileImage)??"https://picsum.photos/200/"),alt:"Profile",className:"w-32 h-32 rounded-full"}),t.jsx("label",{htmlFor:"profile-image",className:"absolute bottom-0 right-0 bg-white text-black rounded-full cursor-pointer border border-gray-300 p-1",children:t.jsx(T,{})}),t.jsx("input",{type:"file",id:"profile-image",name:"imageFile",className:"hidden",onChange:l})]})}),t.jsx("div",{className:"flex-grow",children:t.jsxs("div",{className:"md:grid md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"mb-2",children:[t.jsx("label",{htmlFor:"name",className:"block text-gray-700 font-semibold",children:"Name:"}),t.jsx("input",{type:"text",id:"name",name:"doctorName",value:(s==null?void 0:s.doctorName)??"",onChange:l,className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-fuchsia-500"})]}),t.jsxs("div",{className:"mb-2",children:[t.jsx("label",{htmlFor:"email",className:"block text-gray-700 font-semibold",children:"Email:"}),t.jsx("input",{type:"email",id:"email",name:"email",value:(s==null?void 0:s.email)??"",className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-fuchsia-500",disabled:!0})]}),t.jsxs("div",{className:"mb-2",children:[t.jsx("label",{htmlFor:"phoneNumber",className:"block text-gray-700 font-semibold",children:"Phone Number:"}),t.jsx("input",{type:"tel",id:"phoneNumber",name:"phoneNumber",value:(s==null?void 0:s.phoneNumber)??"",onChange:l,className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-fuchsia-500"})]}),t.jsxs("div",{className:"mb-2",children:[t.jsx("label",{htmlFor:"department",className:"block text-gray-700 font-semibold",children:"Department:"}),t.jsxs("select",{id:"department",name:"department",value:(s==null?void 0:s.department)??"",onChange:l,className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-fuchsia-500",children:[t.jsx("option",{className:"text-gray-700",value:""}),g.map(i=>t.jsx("option",{className:"text-gray-700",value:i._id,children:i.departmentName},i._id))]})]}),t.jsxs("div",{className:"mb-2",children:[t.jsx("label",{htmlFor:"education",className:"block text-gray-700 font-semibold",children:"Education:"}),t.jsx("input",{type:"text",id:"education",name:"education",value:(s==null?void 0:s.education)??"",onChange:l,className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-fuchsia-500"})]}),t.jsxs("div",{className:"mb-2",children:[t.jsx("label",{htmlFor:"description",className:"block text-gray-700 font-semibold",children:"Description:"}),t.jsx("input",{id:"description",name:"description",value:(s==null?void 0:s.description)??"",onChange:l,className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-fuchsia-500"})]})]})})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{htmlFor:"lisenceCertificate",className:"block text-gray-700 font-semibold",children:"Doctor License Certificate:"}),t.jsx("input",{type:"file",id:"lisenceCertificate",name:"lisenceCertificate",className:"border text-gray-700 border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring focus:border-fuchsia-800",onChange:l}),t.jsx("img",{src:u||(n==null?void 0:n.lisenceCertificate),alt:"License Certificate Preview",className:"mt-2 w-48 h-32 object-cover"})]}),t.jsx("p",{className:(s==null?void 0:s.status)==="approved"?"text-fuchsia-800 font-bold":(s==null?void 0:s.status)==="rejected"?"text-red-600 font-bold":"text-yellow-600 font-bold",children:m}),t.jsx("div",{className:"flex justify-center",children:t.jsx("button",{className:"bg-gradient-to-r from-fuchsia-700 to-fuchsia-800 text-white py-2 px-4 mt-5 rounded-md hover:from-fuchsia-600 hover:to-fuchsia-800 focus:outline-none focus:ring focus:border-fuchsia-500",onClick:x,disabled:p,children:p?"Submitting...":"Update Profile"})})]})]})}),t.jsx(M,{style:""})]})};export{te as default};
